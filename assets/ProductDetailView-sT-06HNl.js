import{S as gt,A as Ct}from"./autoplay-BzJjwOr9.js";import{k as J,l as yt,m as Z,p as At,q as It,s as Nt,d as wt,r as k,u as St,c as q,v as xt,o as Lt,x as Ot,a as I,b as N,e,f as x,y as Dt,_ as Rt,w as W,i as kt,z as Vt,F as V,g as z,t as v,h as Pt,j as P,A as $t}from"./index-DlkIuFvD.js";import{a as Mt,c as Xt}from"./products-DRv_-Thk.js";var $={exports:{}},M={exports:{}};var Ut=M.exports,Q;function qt(){return Q||(Q=1,(function(L,b){(function(_,c){L.exports=c(J(),yt(),Z())})(Ut,(function(_,c,T){const o="swipe",l=".bs.swipe",C=`touchstart${l}`,w=`touchmove${l}`,O=`touchend${l}`,u=`pointerdown${l}`,m=`pointerup${l}`,S="touch",d="pen",n="pointer-event",h=40,r={endCallback:null,leftCallback:null,rightCallback:null},f={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class E extends c{constructor(s,y){super(),this._element=s,!(!s||!E.isSupported())&&(this._config=this._getConfig(y),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return r}static get DefaultType(){return f}static get NAME(){return o}dispose(){_.off(this._element,l)}_start(s){if(!this._supportPointerEvents){this._deltaX=s.touches[0].clientX;return}this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX)}_end(s){this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX-this._deltaX),this._handleSwipe(),T.execute(this._config.endCallback)}_move(s){this._deltaX=s.touches&&s.touches.length>1?0:s.touches[0].clientX-this._deltaX}_handleSwipe(){const s=Math.abs(this._deltaX);if(s<=h)return;const y=s/this._deltaX;this._deltaX=0,y&&T.execute(y>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(_.on(this._element,u,s=>this._start(s)),_.on(this._element,m,s=>this._end(s)),this._element.classList.add(n)):(_.on(this._element,C,s=>this._start(s)),_.on(this._element,w,s=>this._move(s)),_.on(this._element,O,s=>this._end(s)))}_eventIsPointerPenTouch(s){return this._supportPointerEvents&&(s.pointerType===d||s.pointerType===S)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}return E}))})(M)),M.exports}var Wt=$.exports,H;function Bt(){return H||(H=1,(function(L,b){(function(_,c){L.exports=c(At(),J(),It(),Nt(),Z(),qt())})(Wt,(function(_,c,T,o,l,C){const w="carousel",u=".bs.carousel",m=".data-api",S="ArrowLeft",d="ArrowRight",n=500,h="next",r="prev",f="left",E="right",j=`slide${u}`,s=`slid${u}`,y=`keydown${u}`,tt=`mouseenter${u}`,et=`mouseleave${u}`,st=`dragstart${u}`,it=`load${u}${m}`,nt=`click${u}${m}`,B="carousel",D="active",ot="slide",rt="carousel-item-end",at="carousel-item-start",lt="carousel-item-next",ct="carousel-item-prev",Y=".active",K=".carousel-item",ut=Y+K,dt=".carousel-item img",_t=".carousel-indicators",ht="[data-bs-slide], [data-bs-slide-to]",pt='[data-bs-ride="carousel"]',mt={[S]:E,[d]:f},ft={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Et={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class A extends _{constructor(t,i){super(t,i),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=o.findOne(_t,this._element),this._addEventListeners(),this._config.ride===B&&this.cycle()}static get Default(){return ft}static get DefaultType(){return Et}static get NAME(){return w}next(){this._slide(h)}nextWhenVisible(){!document.hidden&&l.isVisible(this._element)&&this.next()}prev(){this._slide(r)}pause(){this._isSliding&&l.triggerTransitionEnd(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){c.one(this._element,s,()=>this.cycle());return}this.cycle()}}to(t){const i=this._getItems();if(t>i.length-1||t<0)return;if(this._isSliding){c.one(this._element,s,()=>this.to(t));return}const a=this._getItemIndex(this._getActive());if(a===t)return;const g=t>a?h:r;this._slide(g,i[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&c.on(this._element,y,t=>this._keydown(t)),this._config.pause==="hover"&&(c.on(this._element,tt,()=>this.pause()),c.on(this._element,et,()=>this._maybeEnableCycle())),this._config.touch&&C.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const a of o.find(dt,this._element))c.on(a,st,g=>g.preventDefault());const i={leftCallback:()=>this._slide(this._directionToOrder(f)),rightCallback:()=>this._slide(this._directionToOrder(E)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),n+this._config.interval))}};this._swipeHelper=new C(this._element,i)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const i=mt[t.key];i&&(t.preventDefault(),this._slide(this._directionToOrder(i)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const i=o.findOne(Y,this._indicatorsElement);i.classList.remove(D),i.removeAttribute("aria-current");const a=o.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);a&&(a.classList.add(D),a.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const i=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=i||this._config.defaultInterval}_slide(t,i=null){if(this._isSliding)return;const a=this._getActive(),g=t===h,p=i||l.getNextActiveElement(this._getItems(),a,g,this._config.wrap);if(p===a)return;const F=this._getItemIndex(p),G=Tt=>c.trigger(this._element,Tt,{relatedTarget:p,direction:this._orderToDirection(t),from:this._getItemIndex(a),to:F});if(G(j).defaultPrevented||!a||!p)return;const vt=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(F),this._activeElement=p;const R=g?at:rt,U=g?lt:ct;p.classList.add(U),l.reflow(p),a.classList.add(R),p.classList.add(R);const bt=()=>{p.classList.remove(R,U),p.classList.add(D),a.classList.remove(D,U,R),this._isSliding=!1,G(s)};this._queueCallback(bt,a,this._isAnimated()),vt&&this.cycle()}_isAnimated(){return this._element.classList.contains(ot)}_getActive(){return o.findOne(ut,this._element)}_getItems(){return o.find(K,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return l.isRTL()?t===f?r:h:t===f?h:r}_orderToDirection(t){return l.isRTL()?t===r?f:E:t===r?E:f}static jQueryInterface(t){return this.each(function(){const i=A.getOrCreateInstance(this,t);if(typeof t=="number"){i.to(t);return}if(typeof t=="string"){if(i[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);i[t]()}})}}return c.on(document,nt,ht,function(X){const t=o.getElementFromSelector(this);if(!t||!t.classList.contains(B))return;X.preventDefault();const i=A.getOrCreateInstance(t),a=this.getAttribute("data-bs-slide-to");if(a){i.to(a),i._maybeEnableCycle();return}if(T.getDataAttribute(this,"slide")==="next"){i.next(),i._maybeEnableCycle();return}i.prev(),i._maybeEnableCycle()}),c.on(window,it,()=>{const X=o.find(pt);for(const t of X)A.getOrCreateInstance(t)}),l.defineJQueryPlugin(A),A}))})($)),$.exports}Bt();const Yt={class:"container"},Kt={class:"row align-items-center"},Ft={class:"col-md-7"},Gt={"aria-label":"breadcrumb"},zt={class:"breadcrumb bg-white px-0 mb-0 py-3"},Qt={class:"breadcrumb-item"},Ht={class:"breadcrumb-item"},Jt={id:"carouselExample",class:"carousel slide"},Zt={class:"carousel-container carousel-inner"},jt={class:"carousel-item active"},te=["src"],ee=["src"],se={class:"col-md-5"},ie={class:"fw-bold h1 mb-1"},ne={class:"mb-0 text-muted text-end"},oe={class:"h4 fw-bold text-end"},re={class:"row align-items-center"},ae={class:"col-6"},le={class:"input-group my-3 bg-light rounded"},ce={class:"input-group-prepend"},ue=["disabled"],de=["value"],_e={class:"input-group-append"},he={class:"row my-5"},pe={class:"col-md-4"},me={class:"col-md-3"},fe={style:{"white-space":"pre-wrap"},class:"text-muted"},Ee={class:"swiper-wrapper"},ve={class:"card border-0 mb-4 position-relative position-relative"},be=["src","alt"],Te={class:"card-body p-0"},ge={class:"mb-0 mt-3"},Ce={class:"card-text mb-0"},ye={class:"text-muted"},Se=wt({__name:"ProductDetailView",setup(L){const b=k(1),_=xt(),c=St(),T=q(()=>_.params.id),o=k({category:"",content:"",description:"",id:"",imageUrl:"",imagesUrl:[],is_enabled:0,num:0,origin_price:0,price:0,title:"",unit:""}),l=k([]),C=async()=>{try{const d=await Xt(T.value);o.value=d.data.product}catch{alert("取得產品資訊失敗")}};Lt(()=>{C(),O()});const w=q(()=>o.value?o.value.category:""),O=async()=>{try{const d=await Mt({category:w.value});l.value=d.data.products}catch{alert("取得產品列表失敗")}},u=q(()=>l.value?l.value.filter(d=>d.id!==_.params.id):[]),m=k(null);Ot(()=>u.value,async d=>{d.length>0&&(await $t(),m.value&&new gt(m.value,{modules:[Ct],loop:!0,autoplay:{delay:2500,disableOnInteraction:!1},slidesPerView:2,spaceBetween:10,breakpoints:{767:{slidesPerView:3,spaceBetween:30}}}))});const S=async()=>{c.addCartItem({product_id:T.value,qty:b.value})};return(d,n)=>{const h=kt("RouterLink");return N(),I(V,null,[e("div",Yt,[x(Rt),e("div",Kt,[e("div",Ft,[e("nav",Gt,[e("ol",zt,[e("li",Qt,[x(h,{class:"text-muted",to:"/"},{default:W(()=>[...n[2]||(n[2]=[P("首頁",-1)])]),_:1})]),e("li",Ht,[x(h,{class:"text-muted",to:"/products"},{default:W(()=>[...n[3]||(n[3]=[P("產品列表",-1)])]),_:1})]),n[4]||(n[4]=e("li",{class:"breadcrumb-item active","aria-current":"page"},"產品詳細",-1))])]),e("div",Jt,[e("div",Zt,[e("div",jt,[e("img",{src:o.value?.imageUrl,class:"d-block w-100",alt:"主圖"},null,8,te)]),(N(!0),I(V,null,z(o.value?.imagesUrl.filter(Boolean),r=>(N(),I("div",{key:r,class:"carousel-item"},[e("img",{src:r,class:"d-block w-100",alt:"副圖"},null,8,ee)]))),128))]),n[5]||(n[5]=Vt('<button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="visually-hidden">Previous</span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="visually-hidden">Next</span></button>',2))])]),e("div",se,[e("h2",ie,v(o.value?.title),1),e("p",ne,[e("del",null,"NT$"+v(o.value?.origin_price?.toLocaleString("zh-TW")),1)]),e("p",oe,"NT$"+v(o.value?.price?.toLocaleString("zh-TW")),1),e("div",re,[e("div",ae,[e("div",le,[e("div",ce,[e("button",{onClick:n[0]||(n[0]=r=>b.value--),disabled:b.value<=1,class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1"},[...n[6]||(n[6]=[e("i",{class:"fas fa-minus"},null,-1)])],8,ue)]),e("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none bg-light",readonly:"",value:b.value},null,8,de),e("div",_e,[e("button",{onClick:n[1]||(n[1]=r=>b.value++),class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},[...n[7]||(n[7]=[e("i",{class:"fas fa-plus"},null,-1)])])])])]),e("div",{class:"col-6"},[e("button",{onClick:S,type:"button",class:"text-nowrap btn btn-dark w-100 py-2"}," 加入購物車 ")])])])]),e("div",he,[e("div",pe,[e("p",null,v(o.value?.description),1)]),e("div",me,[e("p",fe,v(o.value?.content),1)])]),u.value.length?(N(),I(V,{key:0},[n[9]||(n[9]=e("h3",{class:"fw-bold"},"你可能會喜歡的植栽",-1)),e("div",{ref_key:"swiperContainer",ref:m,class:"swiper mt-4 mb-5"},[e("div",Ee,[(N(!0),I(V,null,z(u.value,r=>(N(),I("div",{key:r.id,class:"swiper-slide"},[e("div",ve,[e("img",{src:r.imageUrl,class:"card-img-top object-fit-cover rounded-0",style:{height:"280px"},alt:r.title},null,8,be),e("div",Te,[e("h4",ge,[x(h,{to:`/products/${r.id}`},{default:W(()=>[P(v(r.title),1)]),_:2},1032,["to"])]),e("p",Ce,[P(" NT$"+v(r.price.toLocaleString("zh-TW"))+" ",1),e("span",ye,[e("del",null,"NT$"+v(r.origin_price.toLocaleString("zh-TW")),1)])]),n[8]||(n[8]=e("p",{class:"text-muted mt-3"},null,-1))])])]))),128))])],512)],64)):Dt("",!0)]),x(Pt)],64)}}});export{Se as default};
